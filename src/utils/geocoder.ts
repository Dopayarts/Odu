// Static geocoder: converts user-entered location text to [longitude, latitude]
// Covers Nigerian cities, UK, US, Europe, West Africa, and global diaspora locations

type Coord = [number, number]; // [lng, lat]

const CITY: Record<string, Coord> = {
  // ─── Nigeria – SW (Yoruba belt) ───
  'lagos': [3.3792, 6.5244],
  'ikeja': [3.3399, 6.6018],
  'surulere': [3.3500, 6.5000],
  'yaba': [3.3833, 6.5167],
  'lekki': [3.5352, 6.4698],
  'victoria island': [3.4200, 6.4333],
  'vi': [3.4200, 6.4333],
  'lagos island': [3.3958, 6.4531],
  'ajah': [3.6083, 6.4656],
  'ikorodu': [3.5019, 6.6194],
  'badagry': [2.8833, 6.4167],
  'epe': [3.9833, 6.5833],
  'mushin': [3.3500, 6.5333],
  'agege': [3.3167, 6.6000],
  'alimosho': [3.2833, 6.6167],
  'ibadan': [3.9470, 7.3775],
  'abeokuta': [3.3500, 7.1500],
  'ogbomosho': [4.2674, 8.1375],
  'osogbo': [4.5578, 7.7677],
  'ile-ife': [4.5200, 7.4667],
  'ife': [4.5200, 7.4667],
  'ilorin': [4.5500, 8.5000],
  'ondo': [4.8333, 7.1000],
  'akure': [5.1950, 7.2527],
  'ado-ekiti': [5.2220, 7.6237],
  'ado ekiti': [5.2220, 7.6237],
  'ekiti': [5.2220, 7.6237],
  'oyo': [3.9333, 7.8500],
  'sagamu': [3.6500, 6.8333],
  'ijebu-ode': [3.9167, 6.8167],
  'ijebu ode': [3.9167, 6.8167],
  'shagamu': [3.6500, 6.8333],
  'sango': [3.2167, 6.8167],
  'ota': [3.2333, 6.6833],
  'ilaro': [3.0167, 6.8833],
  'iseyin': [3.5967, 7.9667],
  'eruwa': [3.4333, 7.5333],
  'okeho': [3.4000, 8.0833],
  'igboho': [3.7500, 8.8333],
  'shaki': [3.3833, 8.6500],
  'offa': [4.7167, 8.1500],
  'ede': [4.4500, 7.7333],
  'ife-ife': [4.5200, 7.4667],
  'modakeke': [4.5500, 7.4500],
  'ilesa': [4.7333, 7.6333],
  'iwo': [4.1833, 7.6333],
  'inisa': [4.5167, 8.1000],
  'erin-oke': [4.5167, 8.1000],
  // ─── Nigeria – North ───
  'abuja': [7.4898, 9.0579],
  'kano': [8.5167, 12.0000],
  'kaduna': [7.4390, 10.5222],
  'jos': [8.8883, 9.9285],
  'maiduguri': [13.1500, 11.8333],
  'sokoto': [5.2500, 13.0625],
  'zaria': [7.7072, 11.0796],
  'bauchi': [9.8400, 10.3100],
  'gombe': [11.1667, 10.2833],
  'lafia': [8.5000, 8.4833],
  'lokoja': [6.7400, 7.8000],
  'minna': [6.5550, 9.6139],
  'birnin kebbi': [4.2019, 12.4538],
  'dutse': [9.3333, 11.8333],
  'gusau': [6.6700, 12.1700],
  'jalingo': [11.3740, 8.9000],
  'yola': [12.4735, 9.2035],
  'damaturu': [11.9667, 11.7500],
  'katsina': [7.6000, 12.9889],
  'kebbi': [4.2019, 12.4538],
  'nguru': [10.4569, 12.8792],
  // ─── Nigeria – South ───
  'port harcourt': [7.0134, 4.8156],
  'ph': [7.0134, 4.8156],
  'benin city': [5.6037, 6.3350],
  'benin': [5.6037, 6.3350],
  'asaba': [6.7500, 6.2000],
  'warri': [5.7500, 5.5167],
  'sapele': [5.6833, 5.9000],
  'calabar': [8.3167, 4.9500],
  'uyo': [7.9308, 5.0302],
  'owerri': [7.0333, 5.4833],
  'umuahia': [7.4883, 5.5333],
  'enugu': [7.4900, 6.4667],
  'awka': [7.0722, 6.2104],
  'onitsha': [6.7833, 6.1500],
  'aba': [7.3667, 5.1000],
  'yenagoa': [6.2667, 4.9200],
  'abeche': [20.8333, 13.8333],
  'akwa ibom': [7.9308, 5.0302],
  'makurdi': [8.5333, 7.7167],
  'auchi': [6.2667, 7.0667],
  'uromi': [6.3333, 6.7167],
  'ekpoma': [6.1333, 6.7500],
  'agbor': [6.1833, 6.2167],
  'ughelli': [6.0000, 5.5000],
  // ─── UK ───
  'london': [-0.1276, 51.5074],
  'peckham': [-0.0670, 51.4729],
  'brixton': [-0.1143, 51.4614],
  'hackney': [-0.0574, 51.5450],
  'croydon': [-0.1004, 51.3762],
  'wembley': [-0.2985, 51.5534],
  'woolwich': [0.0649, 51.4926],
  'lewisham': [-0.0217, 51.4615],
  'islington': [-0.1085, 51.5416],
  'camden': [-0.1432, 51.5390],
  'southwark': [-0.0882, 51.4996],
  'stratford': [-0.0049, 51.5422],
  'tottenham': [-0.0710, 51.5882],
  'manchester': [-2.2426, 53.4808],
  'birmingham': [-1.8904, 52.4862],
  'leeds': [-1.5491, 53.8008],
  'glasgow': [-4.2518, 55.8642],
  'liverpool': [-2.9916, 53.4084],
  'newcastle': [-1.6178, 54.9783],
  'sheffield': [-1.4701, 53.3811],
  'bristol': [-2.5879, 51.4545],
  'edinburgh': [-3.1883, 55.9533],
  'cardiff': [-3.1791, 51.4816],
  'belfast': [-5.9301, 54.5973],
  'coventry': [-1.5197, 52.4068],
  'leicester': [-1.1398, 52.6369],
  'nottingham': [-1.1581, 52.9548],
  'oxford': [-1.2577, 51.7520],
  'cambridge': [0.1218, 52.2053],
  'southampton': [-1.4049, 50.9097],
  'reading': [-0.9781, 51.4543],
  'portsmouth': [-1.0879, 50.8198],
  'wolverhampton': [-2.1266, 52.5862],
  'derby': [-1.4779, 52.9225],
  'stoke-on-trent': [-2.1839, 53.0027],
  'sunderland': [-1.3769, 54.9049],
  'middlesbrough': [-1.2175, 54.5741],
  'ipswich': [1.1717, 52.0567],
  'norwich': [1.2971, 52.6309],
  'exeter': [-3.5339, 50.7260],
  'hull': [-0.3274, 53.7457],
  'bradford': [-1.7594, 53.7938],
  'plymouth': [-4.1427, 50.3755],
  'swansea': [-3.9436, 51.6214],
  // ─── USA ───
  'new york': [-74.0060, 40.7128],
  'new york city': [-74.0060, 40.7128],
  'nyc': [-74.0060, 40.7128],
  'brooklyn': [-73.9442, 40.6782],
  'bronx': [-73.8648, 40.8448],
  'queens': [-73.7949, 40.7282],
  'harlem': [-73.9442, 40.8116],
  'los angeles': [-118.2437, 34.0522],
  'la': [-118.2437, 34.0522],
  'chicago': [-87.6298, 41.8781],
  'houston': [-95.3698, 29.7604],
  'atlanta': [-84.3880, 33.7490],
  'washington dc': [-77.0369, 38.9072],
  'washington d.c.': [-77.0369, 38.9072],
  'dc': [-77.0369, 38.9072],
  'dallas': [-96.7970, 32.7767],
  'miami': [-80.1918, 25.7617],
  'philadelphia': [-75.1652, 39.9526],
  'phoenix': [-112.0740, 33.4484],
  'san antonio': [-98.4936, 29.4241],
  'san diego': [-117.1611, 32.7157],
  'san francisco': [-122.4194, 37.7749],
  'austin': [-97.7431, 30.2672],
  'columbus': [-82.9988, 39.9612],
  'memphis': [-90.0490, 35.1495],
  'baltimore': [-76.6122, 39.2904],
  'boston': [-71.0589, 42.3601],
  'seattle': [-122.3321, 47.6062],
  'denver': [-104.9903, 39.7392],
  'nashville': [-86.7816, 36.1627],
  'detroit': [-83.0458, 42.3314],
  'portland': [-122.6765, 45.5231],
  'las vegas': [-115.1398, 36.1699],
  'louisville': [-85.7585, 38.2527],
  'oklahoma city': [-97.5164, 35.4676],
  'sacramento': [-121.4944, 38.5816],
  'minneapolis': [-93.2650, 44.9778],
  'raleigh': [-78.6382, 35.7796],
  'new orleans': [-90.0715, 29.9511],
  'cleveland': [-81.6944, 41.4993],
  'tampa': [-82.4572, 27.9506],
  'st louis': [-90.1994, 38.6270],
  'saint louis': [-90.1994, 38.6270],
  'cincinnati': [-84.5120, 39.1031],
  'pittsburgh': [-79.9959, 40.4406],
  'buffalo': [-78.8784, 42.8864],
  'fort worth': [-97.3308, 32.7555],
  'richmond': [-77.4360, 37.5407],
  'charlotte': [-80.8431, 35.2271],
  'jacksonville': [-81.6557, 30.3322],
  'tucson': [-110.9747, 32.2226],
  'kansas city': [-94.5786, 39.0997],
  'virginia beach': [-75.9779, 36.8529],
  'colorado springs': [-104.8214, 38.8339],
  'omaha': [-95.9345, 41.2565],
  'riverside': [-117.3962, 33.9806],
  'greensboro': [-79.7920, 36.0726],
  'durham': [-78.8986, 35.9940],
  'jersey city': [-74.0776, 40.7178],
  // ─── Canada ───
  'toronto': [-79.3832, 43.6532],
  'brampton': [-79.7594, 43.7315],
  'mississauga': [-79.6441, 43.5890],
  'north york': [-79.4150, 43.7615],
  'scarborough': [-79.2318, 43.7731],
  'montreal': [-73.5673, 45.5017],
  'vancouver': [-123.1207, 49.2827],
  'calgary': [-114.0719, 51.0447],
  'edmonton': [-113.4909, 53.5461],
  'ottawa': [-75.6972, 45.4215],
  'winnipeg': [-97.1384, 49.8951],
  'hamilton': [-79.8711, 43.2557],
  // ─── West/Central Africa ───
  'accra': [-0.1870, 5.6037],
  'kumasi': [-1.6241, 6.6884],
  'takoradi': [-1.7584, 4.8929],
  'dakar': [-17.4441, 14.7167],
  'abidjan': [-4.0305, 5.3600],
  'cotonou': [2.4193, 6.3536],
  'lome': [1.2155, 6.1375],
  'ouagadougou': [-1.5616, 12.3647],
  'bamako': [-8.0000, 12.6392],
  'conakry': [-13.7122, 9.5370],
  'freetown': [-13.2317, 8.4881],
  'monrovia': [-10.8047, 6.3106],
  'niamey': [2.1098, 13.5116],
  'ndjamena': [15.0557, 12.1348],
  'libreville': [9.4536, 0.3901],
  'douala': [9.7085, 4.0511],
  'yaounde': [11.5021, 3.8480],
  'bangui': [18.5550, 4.3947],
  // ─── East/Southern Africa ───
  'nairobi': [36.8219, -1.2921],
  'mombasa': [39.6682, -4.0435],
  'dar es salaam': [39.2083, -6.7924],
  'addis ababa': [38.7469, 9.0249],
  'kampala': [32.5825, 0.3476],
  'kigali': [30.0587, -1.9441],
  'kinshasa': [15.3222, -4.3317],
  'johannesburg': [28.0473, -26.2041],
  'cape town': [18.4241, -33.9249],
  'durban': [30.9634, -29.8587],
  'pretoria': [28.1871, -25.7461],
  'harare': [31.0522, -17.8292],
  'lusaka': [28.3228, -15.4166],
  'lilongwe': [33.7741, -13.9626],
  'maputo': [32.5832, -25.9692],
  'antananarivo': [47.5079, -18.9137],
  'gaborone': [25.9140, -24.6540],
  'windhoek': [17.0836, -22.5609],
  // ─── Europe ───
  'paris': [2.3522, 48.8566],
  'berlin': [13.4050, 52.5200],
  'madrid': [-3.7038, 40.4168],
  'rome': [12.4964, 41.9028],
  'milan': [9.1900, 45.4654],
  'amsterdam': [4.9041, 52.3676],
  'brussels': [4.3517, 50.8503],
  'vienna': [16.3738, 48.2082],
  'stockholm': [18.0686, 59.3293],
  'oslo': [10.7522, 59.9139],
  'copenhagen': [12.5683, 55.6761],
  'helsinki': [24.9384, 60.1699],
  'lisbon': [-9.1393, 38.7223],
  'athens': [23.7275, 37.9838],
  'warsaw': [21.0122, 52.2297],
  'budapest': [19.0402, 47.4979],
  'prague': [14.4378, 50.0755],
  'zurich': [8.5417, 47.3769],
  'geneva': [6.1432, 46.2044],
  'dublin': [-6.2603, 53.3498],
  'frankfurt': [8.6821, 50.1109],
  'munich': [11.5820, 48.1351],
  'hamburg': [9.9937, 53.5753],
  'cologne': [6.9603, 50.9333],
  'barcelona': [2.1734, 41.3851],
  'rotterdam': [4.4777, 51.9244],
  'lyon': [4.8357, 45.7640],
  'marseille': [5.3698, 43.2965],
  'toulouse': [1.4442, 43.6047],
  'nice': [7.2620, 43.7102],
  'naples': [14.2681, 40.8518],
  'turin': [7.6762, 45.0703],
  'antwerp': [4.4025, 51.2194],
  'ghent': [3.7174, 51.0543],
  'bern': [7.4474, 46.9480],
  'basel': [7.5886, 47.5596],
  'valletta': [14.5146, 35.8997],
  'riga': [24.1052, 56.9496],
  'tallinn': [24.7536, 59.4370],
  'vilnius': [25.2797, 54.6872],
  'bucharest': [26.1025, 44.4268],
  'sofia': [23.3219, 42.6977],
  'zagreb': [15.9819, 45.8150],
  'belgrade': [20.4651, 44.8176],
  'sarajevo': [18.4131, 43.8563],
  'skopje': [21.4254, 41.9981],
  'tirana': [19.8187, 41.3275],
  'chisinau': [28.8353, 47.0105],
  'kyiv': [30.5238, 50.4501],
  'minsk': [27.5615, 53.9045],
  // ─── Middle East ───
  'dubai': [55.2708, 25.2048],
  'abu dhabi': [54.3773, 24.4539],
  'riyadh': [46.7219, 24.6877],
  'doha': [51.5310, 25.2854],
  'kuwait city': [47.9783, 29.3697],
  'muscat': [58.5922, 23.6139],
  'manama': [50.5860, 26.2154],
  'amman': [35.9106, 31.9539],
  'beirut': [35.5018, 33.8938],
  'cairo': [31.2357, 30.0444],
  'alexandria': [29.9187, 31.2001],
  'tunis': [10.1815, 36.8065],
  'algiers': [3.0588, 36.7372],
  'casablanca': [-7.5898, 33.5731],
  'rabat': [-6.8498, 33.9716],
  'tripoli': [13.1913, 32.8872],
  'khartoum': [32.5599, 15.5007],
  // ─── Asia ───
  'mumbai': [72.8777, 19.0760],
  'delhi': [77.2090, 28.6139],
  'bangalore': [77.5946, 12.9716],
  'chennai': [80.2707, 13.0827],
  'kolkata': [88.3639, 22.5726],
  'hyderabad': [78.4867, 17.3850],
  'beijing': [116.4074, 39.9042],
  'shanghai': [121.4737, 31.2304],
  'guangzhou': [113.2644, 23.1291],
  'shenzhen': [114.0579, 22.5431],
  'hong kong': [114.1694, 22.3193],
  'tokyo': [139.6917, 35.6895],
  'osaka': [135.5022, 34.6937],
  'seoul': [126.9780, 37.5665],
  'singapore': [103.8198, 1.3521],
  'kuala lumpur': [101.6869, 3.1390],
  'jakarta': [106.8456, -6.2088],
  'bangkok': [100.5018, 13.7563],
  'manila': [120.9842, 14.5995],
  'taipei': [121.5654, 25.0330],
  'karachi': [67.0099, 24.8615],
  'lahore': [74.3587, 31.5204],
  'islamabad': [73.0479, 33.6844],
  'dhaka': [90.4125, 23.8103],
  'colombo': [79.8612, 6.9271],
  // ─── Oceania ───
  'sydney': [151.2093, -33.8688],
  'melbourne': [144.9631, -37.8136],
  'brisbane': [153.0251, -27.4698],
  'perth': [115.8605, -31.9505],
  'adelaide': [138.6007, -34.9285],
  'auckland': [174.7633, -36.8485],
  'wellington': [174.7762, -41.2865],
  // ─── Latin America ───
  'sao paulo': [-46.6333, -23.5505],
  'rio de janeiro': [-43.1729, -22.9068],
  'brasilia': [-47.9292, -15.7801],
  'buenos aires': [-58.3816, -34.6037],
  'bogota': [-74.0721, 4.7110],
  'lima': [-77.0428, -12.0464],
  'santiago': [-70.6483, -33.4489],
  'mexico city': [-99.1332, 19.4326],
  'guadalajara': [-103.3496, 20.6597],
  'caracas': [-66.9036, 10.4806],
  'havana': [-82.3666, 23.1136],
  'kingston': [-76.7928, 17.9970],
  'port of spain': [-61.5189, 10.6540],
};

const COUNTRY: Record<string, Coord> = {
  'nigeria': [8.6753, 9.0820],
  'uk': [-3.4360, 55.3781],
  'united kingdom': [-3.4360, 55.3781],
  'england': [-1.5491, 53.0000],
  'scotland': [-4.2026, 56.4907],
  'wales': [-3.7837, 52.1307],
  'northern ireland': [-6.6667, 54.7500],
  'usa': [-98.5795, 39.8283],
  'united states': [-98.5795, 39.8283],
  'us': [-98.5795, 39.8283],
  'america': [-98.5795, 39.8283],
  'canada': [-96.8165, 56.1304],
  'france': [2.2137, 46.2276],
  'germany': [10.4515, 51.1657],
  'italy': [12.5674, 41.8719],
  'spain': [-3.7492, 40.4637],
  'netherlands': [5.2913, 52.1326],
  'holland': [5.2913, 52.1326],
  'belgium': [4.4699, 50.5039],
  'sweden': [18.6435, 60.1282],
  'norway': [8.4689, 60.4720],
  'denmark': [9.5018, 56.2639],
  'finland': [25.7482, 61.9241],
  'ireland': [-8.2439, 53.4129],
  'portugal': [-8.2245, 39.3999],
  'greece': [21.8243, 39.0742],
  'poland': [19.1451, 51.9194],
  'austria': [14.5501, 47.5162],
  'switzerland': [8.2275, 46.8182],
  'ghana': [-1.0232, 7.9465],
  'kenya': [37.9062, -0.0236],
  'south africa': [22.9375, -30.5595],
  'ethiopia': [40.4897, 9.1450],
  'tanzania': [34.8888, -6.3690],
  'uganda': [32.2903, 1.3733],
  'cameroon': [12.3547, 7.3697],
  'senegal': [-14.4524, 14.4974],
  "ivory coast": [-5.5471, 7.5400],
  "cote d'ivoire": [-5.5471, 7.5400],
  'benin republic': [2.3158, 9.3077],
  'togo': [0.8248, 8.6195],
  'mali': [-1.6880, 17.5707],
  'guinea': [-11.3167, 10.3000],
  'sierra leone': [-11.7799, 8.4606],
  'liberia': [-9.4295, 6.4281],
  'niger': [8.0817, 17.6078],
  'chad': [18.7322, 15.4542],
  'malaysia': [109.6977, 4.2105],
  'india': [78.9629, 20.5937],
  'china': [104.1954, 35.8617],
  'japan': [138.2529, 36.2048],
  'australia': [133.7751, -25.2744],
  'new zealand': [174.8860, -40.9006],
  'brazil': [-51.9253, -14.2350],
  'argentina': [-63.6167, -38.4161],
  'colombia': [-74.2973, 4.5709],
  'mexico': [-102.5528, 23.6345],
  'uae': [53.8478, 23.4241],
  'united arab emirates': [53.8478, 23.4241],
  'saudi arabia': [45.0792, 23.8859],
  'qatar': [51.1839, 25.3548],
  'egypt': [30.8025, 26.8206],
  'morocco': [-7.0926, 31.7917],
  'zimbabwe': [29.1549, -20.0000],
  'zambia': [27.8493, -13.1339],
  'rwanda': [29.8739, -1.9403],
  'congo': [15.8277, -0.2280],
  'dr congo': [23.6565, -2.8770],
  'angola': [17.8739, -11.2027],
  'mozambique': [35.5296, -18.6657],
  'malawi': [34.3015, -13.2543],
  'gabon': [11.6094, -0.8037],
  'central african republic': [20.9394, 6.6111],
  'sudan': [30.2176, 12.8628],
  'south sudan': [31.3070, 6.8770],
  'somalia': [46.1996, 5.1521],
  'djibouti': [42.5903, 11.8251],
  'eritrea': [39.7823, 15.1794],
  'pakistan': [69.3451, 30.3753],
  'bangladesh': [90.3563, 23.6850],
  'sri lanka': [80.7718, 7.8731],
  'indonesia': [113.9213, -0.7893],
  'philippines': [121.7740, 12.8797],
  'thailand': [100.9925, 15.8700],
  'vietnam': [108.2772, 14.0583],
  'russia': [105.3188, 61.5240],
  'ukraine': [31.1656, 48.3794],
  'turkey': [35.2433, 38.9637],
  'iran': [53.6880, 32.4279],
  'iraq': [43.6793, 33.2232],
  'israel': [34.8516, 31.0461],
  'jamaica': [-77.2975, 18.1096],
  'trinidad': [-61.2225, 10.6918],
  'trinidad and tobago': [-61.2225, 10.6918],
  'barbados': [-59.5432, 13.1939],
  'cuba': [-77.7812, 21.5218],
};

/** Convert a free-text location string to [lng, lat], or null if unmapped */
export function geocodeLocation(text: string): Coord | null {
  if (!text) return null;
  const norm = text.trim().toLowerCase().replace(/[,./]+$/, '');

  // 1. Exact city match
  if (CITY[norm]) return CITY[norm];

  // 2. Exact country match
  if (COUNTRY[norm]) return COUNTRY[norm];

  // 3. Try splitting "City, Country" — check city part first
  const parts = norm.split(',').map(p => p.trim());
  for (const part of parts) {
    if (CITY[part]) return CITY[part];
  }

  // 4. Then try country part
  for (const part of parts) {
    if (COUNTRY[part]) return COUNTRY[part];
  }

  // 5. Substring match in city keys
  for (const key of Object.keys(CITY)) {
    if (norm.includes(key) || key.includes(norm)) return CITY[key];
  }

  // 6. Substring match in country keys
  for (const key of Object.keys(COUNTRY)) {
    if (norm.includes(key) || key.includes(norm)) return COUNTRY[key];
  }

  return null;
}
